<div class="row mb-4">
  <div class="col-md-8">
    <h1><%= @client.name %></h1>
    <p class="text-muted"><%= @client.phone_number %></p>
  </div>
  <div class="col-md-4 text-end">
    <%= link_to "üìÑ Gerar PDF Nutricional", diet_pdf_client_path(@client), 
                target: "_blank", 
                class: "btn btn-success me-2",
                title: "Visualizar prescri√ß√£o nutricional em PDF" %>
    <%= link_to "Editar Cliente", edit_client_path(@client), class: "btn btn-warning me-2" %>
    <%= link_to "Voltar", clients_path, class: "btn btn-secondary" %>
  </div>
</div>

<div class="row mb-4">
  <div class="col-md-6">
    <div class="card">
      <div class="card-header">
        <h5>Informa√ß√µes do Cliente</h5>
      </div>
      <div class="card-body">
        <p><strong>Status:</strong> 
          <span class="badge bg-<%= @client.status == 'active' ? 'success' : @client.status == 'completed' ? 'primary' : 'secondary' %>">
            <%= @client.status.capitalize %>
          </span>
        </p>
        <p><strong>Per√≠odo:</strong> <%= @client.start_date.strftime('%d/%m/%Y') %> a <%= @client.end_date.strftime('%d/%m/%Y') %></p>
        <p><strong>Valor Pago:</strong> R$ <%= number_with_precision(@client.paid_amount, precision: 2, delimiter: '.', separator: ',') %></p>
        <% if @client.note.present? %>
          <p><strong>Observa√ß√µes:</strong><br>
          <%= simple_format(@client.note) %></p>
        <% end %>
      </div>
    </div>
  </div>
  
  <div class="col-md-6">
    <div class="card">
      <div class="card-header">
        <h5>Estat√≠sticas das Dietas</h5>
      </div>
      <div class="card-body">
        <p><strong>Total de Dietas:</strong> <%= @total_diets %></p>
        <p><strong>Total de Calorias:</strong> <%= @total_calories.round(1) %> kcal</p>
        <div class="d-grid gap-2">
          <%= link_to "üìÑ Gerar PDF Nutricional", diet_pdf_client_path(@client), 
                      target: "_blank", 
                      class: "btn btn-success",
                      title: "Visualizar prescri√ß√£o nutricional completa" %>
          <%= link_to "Ver Dietas", client_diets_path(@client), class: "btn btn-outline-success" %>
          <%= link_to "Nova Dieta", new_client_diet_path(@client), class: "btn btn-primary" %>
        </div>
      </div>
    </div>
  </div>
</div>

<% if @diets.any? %>
  <div class="card">
    <div class="card-header">
      <h5>Dietas do Cliente</h5>
    </div>
    <div class="card-body">
      <div class="row">
        <% @diets.each do |diet| %>
          <div class="col-md-4 mb-3">
            <div class="card border-primary">
              <div class="card-body">
                <h6 class="card-title"><%= diet.name %></h6>
                <p class="card-text">
                  <strong>Tipo:</strong> <%= diet.meal_type.capitalize %><br>
                  <strong>Calorias:</strong> <%= diet.total_calories.round(1) %> kcal
                </p>
                <%= link_to "Ver Dieta", client_diet_path(@client, diet), class: "btn btn-sm btn-primary" %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
<% end %>
